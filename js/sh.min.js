Array.prototype.remove=function(a,b){this.splice(a,!b||1+b-a+(!(b<0^a>=0)&&(b<0||-1)*this.length));return this.length;};String.prototype.toSentenceCase=function(){return this.substring(0,1).toUpperCase()+this.substring(1);};String.prototype.format=function(){if(arguments.length==0){return this;}var a,b=this;if(arguments.length>1){a=$.makeArray(arguments);}else{a=arguments;}$.each(a,function(c,d){b=b.replace(new RegExp("\\{"+c+"\\}","g"),d);});return b;};String.prototype.isNullOrEmpty=function(){if(this==null||this=="undefined"||$.trim(this).length==0){return true;}return false;};String.prototype.toBoolean=function(){if(this.toString()==="true"||this.toString()==="True"){return true;}return false;};Number.prototype.toPrettyPrice=function(){var a=Number(this.toString().replace(/,/gi,"")).toFixed(2),c=a.toString().split("."),d=c[0],e=c.length>1?"."+c[1]:"",b=/(\d+)(\d{3})/;while(b.test(d)){d=d.replace(b,"$1,$2");}return d+e;};String.prototype.toNormalNumber=function(){return this.replace(/,/gi,"");};Number.prototype.toPrettyNumber=function(){var a=Number(this.toString().replace(/,/gi,"")),c=a.toString().split("."),d=c[0],e=c.length>1?"."+c[1]:"",b=/(\d+)(\d{3})/;while(b.test(d)){d=d.replace(b,"$1,$2");}return d+e;};function _debug(b,a,c){if(_mdebug){if(window.console){c=="e"?window.console.error(a,b):window.console.info("%c "+a,"background: #222; color: #bada55",b);}}}var $body;(function(a){a.props={width:0,height:0,$window:a(window),$body:a(document.body),doctitle:document.title,isFixed:false};if(!a.Res){a.Res={};}$body=a(document.body);a.setContentWidth=function(){a.props.width=a(window).width();a.props.height=a(window).height();};a(window).ready(function(){a.props.$body=a(document.body);jQuery.support.placeholder=(function(){var b=document.createElement("input");return"placeholder" in b;})();jQuery.support.touch=(function(){return"ontouchstart" in window||navigator.msMaxTouchPoints;})();a.setContentWidth();if(!a.props.isFixed){a(window).resize(a.setContentWidth);}});})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.toJson=function(g){if(g===""||g==null){return{};}var d=g.split("&"),h={};for(var e=0;e<d.length;e++){var c=d[e].split("="),f=c[0],k=c[1];if(h[f]!=null){if(!(h[f] instanceof Array)){var j=h[f];h[f]=[];h[f].push(j);}h[f].push(k);}else{h[f]=k;}}return h;};a.Sh.Ajax=function(d){var e=this.data("src")||this.attr("href");var f=this.data("style")||(this.attr("data-params")?"qs":"o");var c={url:e,style:f,type:this.data("method"),data:this.data("params"),dataType:this.data("datatype"),contentType:this.data("contentype"),onload:a.getEvent(this,"onload"),onloading:a.getEvent(this,"onloading"),onprepost:a.getEvent(this,"onprepost"),onprogress:a.getEvent(this,"onprogress"),onfinish:a.getEvent(this,"onfinish"),onfinally:a.getEvent(this,"onfinally"),onpost:a.getEvent(this,"onpost"),loadingcss:this.data("loadingcss"),trigger:this.data("trigger"),silent:this.data("silent")};this.ShAjax(a.extend(c,d));return this.data("sh.ajax");};a.Sh.Ajax.defaults={style:"o",type:"POST",dataType:"json",data:{},onload:null,onloading:function(c,d){c?this.addClass("loadings"):this.removeClass("loadings");},onprepost:null,onprogress:null,onfinish:null,onfinally:null,onpost:function(c){_debug(c,"xhr");},loadingcss:"loadings",silent:false};var b=function(c,d){this.element=c;this._IsLoading=false;this.init(d);};b.prototype={init:function(d){this.options=a.extend({},a.Sh.Ajax.defaults,d);this.options.dataobject={};var c=this;if(this.options.onload){this.options.onload.call(this.element);}if(c.options.style=="qs"){c.options.data=a.Sh.toJson(c.options.data);}else{if(c.options.style=="array"){c.options.data=a.Sh.toJson(a.param(c.options.data));}}if(!c.options.silent){if(c.options.trigger){c.element.on("click",c.options.trigger,function(f){if(!a(f.target).is(c.options.trigger)){return false;}return c._click(this,f);});}else{c.element.on("click",function(f){return c._click(this,f);});}}return c;},_click:function(g,f){var d=this;if(f.isDefaultPrevented()||d._IsLoading){return false;}var c=a(g);f.preventDefault();return d.ajax(c);},addparams:function(c,d){switch(d){case"qs":c=a.Sh.toJson(c);break;case"array":c=a.Sh.toJson(a.param(c));break;}a.extend(this.options.data,c);},addtrigger:function(d){var c=this;d.on("click",function(f){return c._click(this,f);});},ajax:function(e){if(!e){e=this.element;}var d=this;if(d.options.onprepost){if(!d.options.onprepost.call(d,e)){return false;}}d.options.onloading.call(d.element,true,e);_debug(d.options.data,"data sent");_debug(d.options.url,"source");d._IsLoading=true;var c={success:function(g,h){_debug(g,"data received");if(d.options.onfinish){d.options.onfinish.call(d.element,g,e);}},error:function(g){_debug(g.responseJSON||g.responseText,"error");if(d.options.onfinish){d.options.onfinish.call(d.element,d.options.dataType=="json"?g.responseJSON:g.responseText,e);}},xhr:function(){myXhr=a.ajaxSettings.xhr();if(myXhr.upload){myXhr.upload.addEventListener("progress",d.options.onprogress,false,e);}return myXhr;},complete:function(h,g){d.options.onloading.call(d.element,false,e);d._IsLoading=false;if(d.options.onfinally){d.options.onfinally.call(d.element,d.options.dataType=="json"?h.responseJSON:h.responseText,g,e);}}};var f=a.ajax(a.extend(c,d.options));d.options.onpost.call(d,f);return this;}};a.fn.ShAjax=function(c){return this.each(function(){if(!a(this).data("sh.ajax")){a(this).data("sh.ajax",new b(a(this),c));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Submit=function(e){var d={successcode:this.data("success-code")};this.ShSubmit(a.extend(d,e));return this.data("sh.submit");};a.Sh.Submit.defaults={successcode:"DONE"};var c=function(d,e){this.element=d;this.init(e);};c.prototype={init:function(f){this.options=a.extend({},a.Sh.Submit.defaults,f);var d=this;var e=a.Sh.Ajax.call(this.element,{onprepost:function(){a.BodyLabel("hide");var g=this.options.style=="array"?d.element.formToArray(true):d.element.formToJson();this.addparams(g,this.options.style);return true;},onloading:function(g){if(g){a.BodyLabel("hide");this.addClass("loadings");}else{this.removeClass("loadings");}},onfinish:function(g){if(g.result){a.BodyLabel(d.options.successcode,{css:"gbodybox"});}else{a.BodyLabel(g.errorCode,{css:"gerrorbox",sticky:true});}}});return this;}};a.fn.ShSubmit=function(d){return this.each(function(){if(!a(this).data("sh.submit")){a(this).data("sh.submit",new c(a(this),d));}});};a.Sh.Delete=function(e){var d={successcode:this.data("success-code"),onafterremove:a.getEvent(this,"onafterremove"),which:this.data("which")};this.ShDelete(a.extend(d,e));return this.data("sh.delete");};a.Sh.Delete.defaults={successcode:"DELETED",which:"li"};var b=function(d,e){this.element=d;this.init(e);};b.prototype={init:function(f){this.options=a.extend({},a.Sh.Delete.defaults,f);var d=this;var e=a.Sh.Ajax.call(this.element,{onloading:function(g){if(g){a.BodyLabel("hide");this.addClass("loadings");}else{this.removeClass("loadings");}},onfinish:function(g){if(g.result){setTimeout(function(){d.element.closest(d.options.which).fadeOut(500,function(){d.element.remove();a.BodyLabel(d.options.successcode,{css:"gbodybox"});if(d.options.onafterremove){d.options.onafterremove.call(d,g);}});},10);}else{a.BodyLabel(g.errorCode,{css:"gerrorbox",sticky:true});}}});return this;}};a.fn.ShDelete=function(d){return this.each(function(){if(!a(this).data("sh.delete")){a(this).data("sh.delete",new b(a(this),d));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.AjaxTip=function(d){var c={css:this.data("css")};this.ShAjaxTip(a.extend(c,d));};a.Sh.AjaxTip.defaults={termcss:"tipterm",pop:undefined};var b=function(d,f){this.options=a.extend({},a.Sh.AjaxTip.defaults,f);this.element=d;this.element.addClass(this.options.termcss);var e="ipop"+b.Counter++;this.element.data("associate",e);if(!this.options.pop){this.options.pop=a("<div />").appendTo(a.props.$body);}this.options.pop.data("associate",e).addClass("tipcard ipop "+(this.options.css||""));var c=this;this.element.data("ondocumentclick",function(g){if(this.get(0)!=g.target&&!jQuery.contains(c.element.get(0),g.target)&&!jQuery.contains(c.options.pop.get(0),g.target)){c.options.pop.hide();}});window.popbasket.push(this.element);this.init(f);};b.prototype={init:function(d){var c=this;this.pop=this.options.pop;a.Sh.Ajax.call(c.element,{method:"GET",onloading:function(e){if(e){c.pop.show();c.pop.position({of:c.element,my:"right top",at:"right bottom"});c.pop.addClass("loading");}else{c.pop.removeClass("loading");}},onprepost:function(){if(c.element.data("latched")){a.props.$body.trigger("click");c.pop.show();c.pop.position({of:c.element,my:"left top",at:"left bottom"});return false;}else{return true;}},onfinish:function(e){if(e.result){c.pop.html(e.d);c.element.data("latched",true);a.ShRewire(c.pop);}else{c.pop.html("oh oh!");}}});return this;}};b.Counter=0;a.fn.ShAjaxTip=function(c){return this.each(function(){if(!a(this).data("sh.ajaxtip")){a(this).data("sh.ajaxtip",new b(a(this),c));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Autocomplete=function(d){var c={source:this.data("source"),target:this.data("target"),context:this.data("context"),isInline:this.data("inline"),minLength:this.data("min-chars"),noCache:this.data("nocache"),onload:a.getEvent(this,"onload"),onchange:a.getEvent(this,"onchange"),onresponse:a.getEvent(this,"onresponse"),onselect:a.getEvent(this,"onselect"),onblur:a.getEvent(this,"onblur")};this.ShAutocomplete(a.extend(c,d));return a(this).data("sh.autocomplete");};a.Sh.Autocomplete.defaults={minLength:0,context:a.props.$body};var b=function(c,d){this.options=a.extend({},a.Sh.Autocomplete.defaults,d);this.element=c;this.target=a(this.options.target,this.options.context);this.cache={};this.init(d);};b.prototype={init:function(e){var d=this,f;if(d.options.isInline){f=this.options.source;}else{var c=a.Sh.Ajax.call(d.element,{method:"GET",silent:true,url:d.options.source});f=function(g,h){if(!d.options.noCache&&g.term in d.cache){h(d.cache[g.term]);return;}c.addparams({kw:g.term});c.options.onfinish=function(i){d.cache[g.term]=i.d;h(i.d);};c.ajax();};}this.element.autocomplete({source:f,minLength:d.options.minLength,select:function(g,h){_debug(h.item,"item");if(h.item){d.element.val(h.item.value);d.target.ShVal(h.item.dbid);if(d.options.onselect){d.options.onselect.call(d.element,h.item);}return false;}},change:function(g,h){if(h.item==null){h.item={currentValue:d.element.val()};d.element.val("");d.target.ShVal(null);}if(d.options.onchange){d.options.onchange.call(d.element,h.item);}},response:function(g,h){if(d.options.onresponse){d.options.onresponse.call(d.element,h.content);}}}).blur(function(){if(d.element.ShTrim()==""){d.target.ShVal(null);}if(d.options.onblur){d.options.onblur.call(d.element);}});this.element.one("input",function(h){var g=a(this);var i=g.val();g.val("");setTimeout(function(){g.val(i);},500);});this.element.trigger("input");return this;},changeTarget:function(c){this.options.target=c;this.target=a(c);}};a.fn.ShAutocomplete=function(c){return this.each(function(){if(!a(this).data("sh.autocomplete")){a(this).data("sh.autocomplete",new b(a(this),c));}});};})(jQuery);(function(a){a.fn.autogrow=function(f){function e(h){var k=a(this),g=k.innerHeight(),l=k.prop("scrollHeight"),j=k.data("autogrow-start-height")||0,m;if(g<l){this.scrollTop=0;f.animate?k.stop().animate({height:l},f.speed):k.innerHeight(l);}else{if(!h||h.which==8||h.which==46||h.ctrlKey&&h.which==88){if(g>j){m=k.clone().addClass(f.cloneClass).css({position:"absolute",zIndex:-10}).val(k.val());k.after(m);do{l=m[0].scrollHeight-1;m.innerHeight(l);}while(l===m[0].scrollHeight);l++;m.remove();l<j&&(l=j);g>l&&f.animate?k.stop().animate({height:l},f.speed):k.innerHeight(l);}else{k.innerHeight(j);}}}}var c=a(this).css({overflow:"hidden",resize:"none"}),d=c.selector,b={context:a(document),animate:true,speed:200,fixMinHeight:true,cloneClass:"autogrowclone",onInitialize:false};f=a.isPlainObject(f)?f:{context:f?f:a(document)};f=a.extend({},b,f);c.each(function(h,k){var g,j;k=a(k);if(k.is(":visible")||parseInt(k.css("height"),10)>0){g=parseInt(k.css("height"),10)||k.innerHeight();}else{j=k.clone().addClass(f.cloneClass).val(k.val()).css({position:"absolute",visibility:"hidden",display:"block"});a("body").append(j);g=j.innerHeight();j.remove();}if(f.fixMinHeight){k.data("autogrow-start-height",g);}k.css("height",g);if(f.onInitialize){e.call(k);}});f.context.on("keyup paste",d,e);};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.AutoGrow=function(){var c=this.data("fixed-minimum")||false,b=this.data("animate")||false,d=this.data("init")||false;this.autogrow({fixMinHeight:c,context:this,animate:b,onInitialize:d});};})(jQuery);$(function(){$.props._BehaviorsReady=false;var a=function(c){try{if($.Sh[c]&&typeof($.Sh[c])=="function"){return $.Sh[c];}else{if(window[c]&&typeof(window[c])=="function"){return window[c];}}_debug(c,"Behavior is missing","e");return null;}catch(b){_debug(c,"Behavior","e");_debug(b,"Error","e");return null;}};$.getEvent=function(b,c){var c=b.data(c);if(!c||c==null){return undefined;}if($.UiSh[c]&&typeof($.UiSh[c])=="function"){return $.UiSh[c];}return c;};window.popbasket=[];$.Behaviors=function(c,d){var b;if(c==null){b=$("[data-behavior]");}else{b=d?$("[data-behavior]",c):jQuery.merge(c.filter("[data-behavior]"),$("[data-behavior]",c));}$.each(b,function(g,h){var e=$(this);var f=e.attr("data-behavior").split(",");$.each(f,function(k,l){var j=a(l);j?j.call(e):null;});});$.props.$body.trigger("BehaviorsReady",[c]);$.props._BehaviorsReady=true;};$.fn.ApplyBehavior=function(c){var d=c.split(",");var b=$(this);$.each(d,function(f,g){var e=a(g);e?e.call(b):null;});return this;};$.ShRewire=function(b,c){$.Behaviors(b,c);if($.Sh.Modals){$.Sh.Modals.rewire(b);}if($.rewireload!=null&&typeof $.rewireload=="function"){$.rewireload(b);}};$.Behaviors();$.props.$body.on("click",function(b){$.each(window.popbasket,function(d,e){var c=e.data("ondocumentclick");if(typeof(c)=="function"){c.call(e,b);}});});});function attachEvents(b){for(var a in b){var d=this.data(a);if(d){var c=window[d];if(typeof(c)==="function"){b[a]=c;}else{b[a]=d;}}}}(function(){var a,e,f,g,d,c={}.hasOwnProperty,b=function(h,k){for(var j in k){if(c.call(k,j)){h[j]=k[j];}}function i(){this.constructor=h;}i.prototype=k.prototype;h.prototype=new i();h.__super__=k.prototype;return h;};g=(function(){function h(){this.options_index=0;this.parsed=[];}h.prototype.add_node=function(i){if(i.nodeName.toUpperCase()==="OPTGROUP"){return this.add_group(i);}else{return this.add_option(i);}};h.prototype.add_group=function(m){var n,o,i,j,k,l;n=this.parsed.length;this.parsed.push({array_index:n,group:true,label:this.escapeExpression(m.label),children:0,disabled:m.disabled});k=m.childNodes;l=[];for(i=0,j=k.length;i<j;i++){o=k[i];l.push(this.add_option(o,n,m.disabled));}return l;};h.prototype.add_option=function(k,j,i){if(k.nodeName.toUpperCase()==="OPTION"){if(k.text!==""){if(j!=null){this.parsed[j].children+=1;}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:k.value,text:k.text,html:k.innerHTML,selected:k.selected,disabled:i===true?i:k.disabled,group_array_index:j,classes:k.className,style:k.style.cssText});}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true});}return this.options_index+=1;}};h.prototype.escapeExpression=function(j){var i,k;if((j==null)||j===false){return"";}if(!/[\&\<\>\"\'\`]/.test(j)){return j;}i={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};k=/&(?!\w+;)|[\<\>\"\'\`]/g;return j.replace(k,function(l){return i[l]||"&amp;";});};return h;})();g.select_to_array=function(m){var k,l,h,i,j;l=new g();j=m.childNodes;for(h=0,i=j.length;h<i;h++){k=j[h];l.add_node(k);}return l.parsed;};e=(function(){function h(i,j){this.form_field=i;this.options=j!=null?j:{};if(!h.browser_is_supported()){return;}this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();}h.prototype.set_default_values=function(){var i=this;this.click_test_action=function(j){return i.test_active_click(j);};this.activate_action=function(j){return i.activate_field(j);};this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&(this.form_field.options[0]!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.group_search=this.options.group_search!=null?this.options.group_search:true;this.search_contains=this.options.search_contains||false;this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:true;this.max_selected_options=this.options.max_selected_options||Infinity;this.inherit_select_classes=this.options.inherit_select_classes||false;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;return this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true;};h.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder")){this.default_text=this.form_field.getAttribute("data-placeholder");}else{if(this.is_multiple){this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||h.default_multiple_text;}else{this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||h.default_single_text;}}return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||h.default_no_result_text;};h.prototype.mouse_enter=function(){return this.mouse_on_container=true;};h.prototype.mouse_leave=function(){return this.mouse_on_container=false;};h.prototype.input_focus=function(j){var i=this;if(this.is_multiple){if(!this.active_field){return setTimeout((function(){return i.container_mousedown();}),50);}}else{if(!this.active_field){return this.activate_field();}}};h.prototype.input_blur=function(j){var i=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout((function(){return i.blur_test();}),100);}};h.prototype.results_option_build=function(n){var l,m,i,j,k;l="";k=this.results_data;for(i=0,j=k.length;i<j;i++){m=k[i];if(m.group){l+=this.result_add_group(m);}else{l+=this.result_add_option(m);}if(n!=null?n.first:void 0){if(m.selected&&this.is_multiple){this.choice_build(m);}else{if(m.selected&&!this.is_multiple){this.single_set_selected_text(m.text);}}}}return l;};h.prototype.result_add_option=function(j){var i,k;if(!j.search_match){return"";}if(!this.include_option_in_results(j)){return"";}i=[];if(!j.disabled&&!(j.selected&&this.is_multiple)){i.push("active-result");}if(j.disabled&&!(j.selected&&this.is_multiple)){i.push("disabled-result");}if(j.selected){i.push("result-selected");}if(j.group_array_index!=null){i.push("group-option");}if(j.classes!==""){i.push(j.classes);}k=document.createElement("li");k.className=i.join(" ");k.style.cssText=j.style;k.setAttribute("data-option-array-index",j.array_index);k.innerHTML=j.search_text;return this.outerHTML(k);};h.prototype.result_add_group=function(i){var j;if(!(i.search_match||i.group_match)){return"";}if(!(i.active_options>0)){return"";}j=document.createElement("li");j.className="group-result";j.innerHTML=i.search_text;return this.outerHTML(j);};h.prototype.results_update_field=function(){this.set_default_text();if(!this.is_multiple){this.results_reset_cleanup();}this.result_clear_highlight();this.results_build();if(this.results_showing){return this.winnow_results();}};h.prototype.reset_single_select_options=function(){var m,i,j,k,l;k=this.results_data;l=[];for(i=0,j=k.length;i<j;i++){m=k[i];if(m.selected){l.push(m.selected=false);}else{l.push(void 0);}}return l;};h.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide();}else{return this.results_show();}};h.prototype.results_search=function(i){if(this.results_showing){return this.winnow_results();}else{return this.results_show();}};h.prototype.winnow_results=function(){var l,m,n,o,p,q,r,s,t,u,i,j,k;this.no_results_clear();p=0;r=this.get_search_text();l=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");o=this.search_contains?"":"^";n=new RegExp(o+l,"i");u=new RegExp(l,"i");k=this.results_data;for(i=0,j=k.length;i<j;i++){m=k[i];m.search_match=false;q=null;if(this.include_option_in_results(m)){if(m.group){m.group_match=false;m.active_options=0;}if((m.group_array_index!=null)&&this.results_data[m.group_array_index]){q=this.results_data[m.group_array_index];if(q.active_options===0&&q.search_match){p+=1;}q.active_options+=1;}if(!(m.group&&!this.group_search)){m.search_text=m.group?m.label:m.html;m.search_match=this.search_string_match(m.search_text,n);if(m.search_match&&!m.group){p+=1;}if(m.search_match){if(r.length){s=m.search_text.search(u);t=m.search_text.substr(0,s+r.length)+"</em>"+m.search_text.substr(s+r.length);m.search_text=t.substr(0,s)+"<em>"+t.substr(s);}if(q!=null){q.group_match=true;}}else{if((m.group_array_index!=null)&&this.results_data[m.group_array_index].search_match){m.search_match=true;}}}}}this.result_clear_highlight();if(p<1&&r.length){this.update_results_content("");return this.no_results(r);}else{this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight();}};h.prototype.search_string_match=function(n,m){var k,l,i,j;if(m.test(n)){return true;}else{if(this.enable_split_word_search&&(n.indexOf(" ")>=0||n.indexOf("[")===0)){l=n.replace(/\[|\]/g,"").split(" ");if(l.length){for(i=0,j=l.length;i<j;i++){k=l[i];if(m.test(k)){return true;}}}}}};h.prototype.choices_count=function(){var l,i,j,k;if(this.selected_option_count!=null){return this.selected_option_count;}this.selected_option_count=0;k=this.form_field.options;for(i=0,j=k.length;i<j;i++){l=k[i];if(l.selected){this.selected_option_count+=1;}}return this.selected_option_count;};h.prototype.choices_click=function(i){i.preventDefault();if(!(this.results_showing||this.is_disabled)){return this.results_show();}};h.prototype.keyup_checker=function(j){var k,i;k=(i=j.which)!=null?i:j.keyCode;this.search_field_scale();switch(k){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){return this.keydown_backstroke();}else{if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search();}}break;case 13:j.preventDefault();if(this.results_showing){return this.result_select(j);}break;case 27:if(this.results_showing){this.results_hide();}return true;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search();}};h.prototype.clipboard_event_checker=function(j){var i=this;return setTimeout((function(){return i.results_search();}),50);};h.prototype.container_width=function(){if(this.options.width!=null){return this.options.width;}else{return""+a(this.form_field).outerWidth()+"px";}};h.prototype.include_option_in_results=function(i){if(this.is_multiple&&(!this.display_selected_options&&i.selected)){return false;}if(!this.display_disabled_options&&i.disabled){return false;}if(i.empty){return false;}return true;};h.prototype.search_results_touchstart=function(i){this.touch_started=true;return this.search_results_mouseover(i);};h.prototype.search_results_touchmove=function(i){this.touch_started=false;return this.search_results_mouseout(i);};h.prototype.search_results_touchend=function(i){if(this.touch_started){return this.search_results_mouseup(i);}};h.prototype.outerHTML=function(i){var j;if(i.outerHTML){return i.outerHTML;}j=document.createElement("div");j.appendChild(i);return j.innerHTML;};h.browser_is_supported=function(){if(window.navigator.appName==="Microsoft Internet Explorer"){return document.documentMode>=8;}if(/iP(od|hone)/i.test(window.navigator.userAgent)){return false;}if(/Android/i.test(window.navigator.userAgent)){if(/Mobile/i.test(window.navigator.userAgent)){return false;}}return true;};h.default_multiple_text="Select Some Options";h.default_single_text="Select an Option";h.default_no_result_text="No results match";return h;})();a=jQuery;a.fn.extend({chosen:function(h){if(!e.browser_is_supported()){return this;}return this.each(function(k){var i,j;i=a(this);j=i.data("chosen");if(h==="destroy"&&j){j.destroy();}else{if(!j){i.data("chosen",new f(this,h));}}});}});f=(function(h){b(i,h);function i(){d=i.__super__.constructor.apply(this,arguments);return d;}i.prototype.setup=function(){this.form_field_jq=a(this.form_field);this.current_selectedIndex=this.form_field.selectedIndex;return this.is_rtl=this.form_field_jq.hasClass("chosen-rtl");};i.prototype.set_up_html=function(){var j,k;j=["chosen-container"];j.push("chosen-container-"+(this.is_multiple?"multi":"single"));if(this.inherit_select_classes&&this.form_field.className){j.push(this.form_field.className);}if(this.is_rtl){j.push("chosen-rtl");}k={"class":j.join(" "),style:"width: "+(this.container_width())+";",title:this.form_field.title};if(this.form_field.id.length){k.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen";}this.container=a("<div />",k);if(this.is_multiple){this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>');}else{this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>');}this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chosen-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chosen-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chosen-choices").first();this.search_container=this.container.find("li.search-field").first();}else{this.search_container=this.container.find("div.chosen-search").first();this.selected_item=this.container.find(".chosen-single").first();}this.results_build();this.set_tab_index();this.set_label_behavior();return this.form_field_jq.trigger("chosen:ready",{chosen:this});};i.prototype.register_observers=function(){var j=this;this.container.bind("mousedown.chosen",function(k){j.container_mousedown(k);});this.container.bind("mouseup.chosen",function(k){j.container_mouseup(k);});this.container.bind("mouseenter.chosen",function(k){j.mouse_enter(k);});this.container.bind("mouseleave.chosen",function(k){j.mouse_leave(k);});this.search_results.bind("mouseup.chosen",function(k){j.search_results_mouseup(k);});this.search_results.bind("mouseover.chosen",function(k){j.search_results_mouseover(k);});this.search_results.bind("mouseout.chosen",function(k){j.search_results_mouseout(k);});this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(k){j.search_results_mousewheel(k);});this.search_results.bind("touchstart.chosen",function(k){j.search_results_touchstart(k);});this.search_results.bind("touchmove.chosen",function(k){j.search_results_touchmove(k);});this.search_results.bind("touchend.chosen",function(k){j.search_results_touchend(k);});this.form_field_jq.bind("chosen:updated.chosen",function(k){j.results_update_field(k);});this.form_field_jq.bind("chosen:activate.chosen",function(k){j.activate_field(k);});this.form_field_jq.bind("chosen:open.chosen",function(k){j.container_mousedown(k);});this.form_field_jq.bind("chosen:close.chosen",function(k){j.input_blur(k);});this.search_field.bind("blur.chosen",function(k){j.input_blur(k);});this.search_field.bind("keyup.chosen",function(k){j.keyup_checker(k);});this.search_field.bind("keydown.chosen",function(k){j.keydown_checker(k);});this.search_field.bind("focus.chosen",function(k){j.input_focus(k);});this.search_field.bind("cut.chosen",function(k){j.clipboard_event_checker(k);});this.search_field.bind("paste.chosen",function(k){j.clipboard_event_checker(k);});if(this.is_multiple){return this.search_choices.bind("click.chosen",function(k){j.choices_click(k);});}else{return this.container.bind("click.chosen",function(k){k.preventDefault();});}};i.prototype.destroy=function(){a(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);if(this.search_field[0].tabIndex){this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex;}this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show();};i.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chosen-disabled");this.search_field[0].disabled=true;if(!this.is_multiple){this.selected_item.unbind("focus.chosen",this.activate_action);}return this.close_field();}else{this.container.removeClass("chosen-disabled");this.search_field[0].disabled=false;if(!this.is_multiple){return this.selected_item.bind("focus.chosen",this.activate_action);}}};i.prototype.container_mousedown=function(j){if(!this.is_disabled){if(j&&j.type==="mousedown"&&!this.results_showing){j.preventDefault();}if(!((j!=null)&&(a(j.target)).hasClass("search-choice-close"))){if(!this.active_field){if(this.is_multiple){this.search_field.val("");}a(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action);this.results_show();}else{if(!this.is_multiple&&j&&((a(j.target)[0]===this.selected_item[0])||a(j.target).parents("a.chosen-single").length)){j.preventDefault();this.results_toggle();}}return this.activate_field();}}};i.prototype.container_mouseup=function(j){if(j.target.nodeName==="ABBR"&&!this.is_disabled){return this.results_reset(j);}};i.prototype.search_results_mousewheel=function(k){var j;if(k.originalEvent){j=-k.originalEvent.wheelDelta||k.originalEvent.detail;}if(j!=null){k.preventDefault();if(k.type==="DOMMouseScroll"){j=j*40;}return this.search_results.scrollTop(j+this.search_results.scrollTop());}};i.prototype.blur_test=function(j){if(!this.active_field&&this.container.hasClass("chosen-container-active")){return this.close_field();}};i.prototype.close_field=function(){a(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();return this.search_field_scale();};i.prototype.activate_field=function(){this.container.addClass("chosen-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus();};i.prototype.test_active_click=function(k){var j;j=a(k.target).closest(".chosen-container");if(j.length&&this.container[0]===j[0]){return this.active_field=true;}else{return this.close_field();}};i.prototype.results_build=function(){this.parsing=true;this.selected_option_count=null;this.results_data=g.select_to_array(this.form_field);if(this.is_multiple){this.search_choices.find("li.search-choice").remove();}else{if(!this.is_multiple){this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=true;this.container.addClass("chosen-container-single-nosearch");}else{this.search_field[0].readOnly=false;this.container.removeClass("chosen-container-single-nosearch");}}}this.update_results_content(this.results_option_build({first:true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=false;};i.prototype.result_do_highlight=function(j){var k,l,m,n,o;if(j.length){this.result_clear_highlight();this.result_highlight=j;this.result_highlight.addClass("highlighted");m=parseInt(this.search_results.css("maxHeight"),10);o=this.search_results.scrollTop();n=m+o;l=this.result_highlight.position().top+this.search_results.scrollTop();k=l+this.result_highlight.outerHeight();if(k>=n){return this.search_results.scrollTop((k-m)>0?k-m:0);}else{if(l<o){return this.search_results.scrollTop(l);}}}};i.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted");}return this.result_highlight=null;};i.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false;}this.container.addClass("chosen-with-drop");this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());this.winnow_results();return this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this});};i.prototype.update_results_content=function(j){return this.search_results.html(j);};i.prototype.results_hide=function(){if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chosen-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this});}return this.results_showing=false;};i.prototype.set_tab_index=function(j){var k;if(this.form_field.tabIndex){k=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=k;}};i.prototype.set_label_behavior=function(){var j=this;this.form_field_label=this.form_field_jq.parents("label");if(!this.form_field_label.length&&this.form_field.id.length){this.form_field_label=a("label[for='"+this.form_field.id+"']");}if(this.form_field_label.length>0){return this.form_field_label.bind("click.chosen",function(k){if(j.is_multiple){return j.container_mousedown(k);}else{return j.activate_field();}});}};i.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default");}else{this.search_field.val("");return this.search_field.removeClass("default");}};i.prototype.search_results_mouseup=function(j){var k;k=a(j.target).hasClass("active-result")?a(j.target):a(j.target).parents(".active-result").first();if(k.length){this.result_highlight=k;this.result_select(j);return this.search_field.focus();}};i.prototype.search_results_mouseover=function(j){var k;k=a(j.target).hasClass("active-result")?a(j.target):a(j.target).parents(".active-result").first();if(k){return this.result_do_highlight(k);}};i.prototype.search_results_mouseout=function(j){if(a(j.target).hasClass("active-result"||a(j.target).parents(".active-result").first())){return this.result_clear_highlight();}};i.prototype.choice_build=function(m){var k,l,j=this;k=a("<li />",{"class":"search-choice"}).html("<span>"+m.html+"</span>");if(m.disabled){k.addClass("search-choice-disabled");}else{l=a("<a />",{"class":"search-choice-close","data-option-array-index":m.array_index});l.bind("click.chosen",function(n){return j.choice_destroy_link_click(n);});k.append(l);}return this.search_container.before(k);};i.prototype.choice_destroy_link_click=function(j){j.preventDefault();j.stopPropagation();if(!this.is_disabled){return this.choice_destroy(a(j.target));}};i.prototype.choice_destroy=function(j){if(this.result_deselect(j[0].getAttribute("data-option-array-index"))){this.show_search_field_default();if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){this.results_hide();}j.parents("li").first().remove();return this.search_field_scale();}};i.prototype.results_reset=function(){this.reset_single_select_options();this.form_field.options[0].selected=true;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide();}};i.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove();};i.prototype.result_select=function(j){var k,l;if(this.result_highlight){k=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false;}if(this.is_multiple){k.removeClass("active-result");}else{this.reset_single_select_options();}l=this.results_data[k[0].getAttribute("data-option-array-index")];l.selected=true;this.form_field.options[l.options_index].selected=true;this.selected_option_count=null;if(this.is_multiple){this.choice_build(l);}else{this.single_set_selected_text(l.text);}if(!((j.metaKey||j.ctrlKey)&&this.is_multiple)){this.results_hide();}this.search_field.val("");if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex){this.form_field_jq.trigger("change",{selected:this.form_field.options[l.options_index].value});}this.current_selectedIndex=this.form_field.selectedIndex;return this.search_field_scale();}};i.prototype.single_set_selected_text=function(j){if(j==null){j=this.default_text;}if(j===this.default_text){this.selected_item.addClass("chosen-default");}else{this.single_deselect_control_build();this.selected_item.removeClass("chosen-default");}return this.selected_item.find("span").text(j);};i.prototype.result_deselect=function(j){var k;k=this.results_data[j];if(!this.form_field.options[k.options_index].disabled){k.selected=false;this.form_field.options[k.options_index].selected=false;this.selected_option_count=null;this.result_clear_highlight();if(this.results_showing){this.winnow_results();}this.form_field_jq.trigger("change",{deselected:this.form_field.options[k.options_index].value});this.search_field_scale();return true;}else{return false;}};i.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect){return;}if(!this.selected_item.find("abbr").length){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>');}return this.selected_item.addClass("chosen-single-with-deselect");};i.prototype.get_search_text=function(){if(this.search_field.val()===this.default_text){return"";}else{return a("<div/>").text(a.trim(this.search_field.val())).html();}};i.prototype.winnow_results_set_highlight=function(){var j,k;k=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];j=k.length?k.first():this.search_results.find(".active-result").first();if(j!=null){return this.result_do_highlight(j);}};i.prototype.no_results=function(k){var j;j=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');j.find("span").first().html(k);this.search_results.append(j);return this.form_field_jq.trigger("chosen:no_results",{chosen:this});};i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove();};i.prototype.keydown_arrow=function(){var j;if(this.results_showing&&this.result_highlight){j=this.result_highlight.nextAll("li.active-result").first();if(j){return this.result_do_highlight(j);}}else{return this.results_show();}};i.prototype.keyup_arrow=function(){var j;if(!this.results_showing&&!this.is_multiple){return this.results_show();}else{if(this.result_highlight){j=this.result_highlight.prevAll("li.active-result");if(j.length){return this.result_do_highlight(j.first());}else{if(this.choices_count()>0){this.results_hide();}return this.result_clear_highlight();}}}};i.prototype.keydown_backstroke=function(){var j;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke();}else{j=this.search_container.siblings("li.search-choice").last();if(j.length&&!j.hasClass("search-choice-disabled")){this.pending_backstroke=j;if(this.single_backstroke_delete){return this.keydown_backstroke();}else{return this.pending_backstroke.addClass("search-choice-focus");}}}};i.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus");}return this.pending_backstroke=null;};i.prototype.keydown_checker=function(k){var l,j;l=(j=k.which)!=null?j:k.keyCode;this.search_field_scale();if(l!==8&&this.pending_backstroke){this.clear_backstroke();}switch(l){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(this.results_showing&&!this.is_multiple){this.result_select(k);}this.mouse_on_container=false;break;case 13:k.preventDefault();break;case 38:k.preventDefault();this.keyup_arrow();break;case 40:k.preventDefault();this.keydown_arrow();break;}};i.prototype.search_field_scale=function(){var l,m,n,o,p,q,r,j,k;if(this.is_multiple){n=0;r=0;p="position:absolute; left: -1000px; top: -1000px; display:none;";q=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(j=0,k=q.length;j<k;j++){o=q[j];p+=o+":"+this.search_field.css(o)+";";}l=a("<div />",{style:p});l.text(this.search_field.val());a("body").append(l);r=l.width()+25;l.remove();m=this.container.outerWidth();if(r>m-10){r=m-10;}return this.search_field.css({width:r+"px"});}};return i;})(e);}).call(this);(function(a){if(!a.Sh){a.Sh={};}if(!a.Res){a.Res={};}a.Sh.Chosen=function(d){var c={dselect:this.data("deselect"),nosearh:this.data("nosearch"),threshold:this.data("threshold"),noresults:this.data("noresults"),width:this.data("width")};this.ShChosen(a.extend(c,d));};a.Sh.Chosen.defaults={threshold:1,noresults:a.Res.NoResults};var b=function(d,e){this.element=d;this.options=a.extend({},a.Sh.Chosen.defaults,e);if(this.options.dselect){var c=a("<option></option>").prependTo(this.element);if(!this.element.find("option[selected]").length){this.element.get(0).selectedIndex=0;}}this.element.chosen({allow_single_deselect:this.options.dselect,disable_search:this.options.nosearch,disable_search_threshold:this.options.threshold,no_results_text:this.options.noresults,width:this.options.width});};a.fn.ShChosen=function(c){return this.each(function(){if(!a(this).data("sh.chosen")){a(this).data("sh.chosen",new b(a(this),c));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Date=function(e){var d={changeMonth:this.data("changemonth"),changeYear:this.data("changeyear"),dateFormat:this.data("dateformat"),maxDate:this.data("maxdate"),minDate:this.data("mindate")};this.ShDate(a.extend(d,e));return a(this).data("sh.date");};a.Sh.Date.defaults={dateFrmat:"mm/dd/yy",maxDaet:null,minDate:null};var b=function(d,e){this.options=a.extend({},a.Sh.Date.defaults,e);this.element=d;this.init(e);};b.prototype={init:function(e){var d=this;this.element.datepicker({dateFormat:d.options.dateFormat,changeMonth:d.options.changeMonth,changeYear:d.options.changeYear,minDate:d.options.minDate,maxDate:d.options.maxDate});this.instance=this.element.data("datepicker");return this;},setLimit:function(d,e){if(!d||d==""){return this;}d=a.datepicker.parseDate(this.options.dateFormat,d,this.instance.settings);this.element.datepicker("option",e=="min"?"minDate":"maxDate",d);return this;}};a.fn.ShDate=function(d){return this.each(function(){if(!a(this).data("sh.date")){a(this).data("sh.date",new b(a(this),d));}});};a.Sh.DateRange=function(){this.ShDateRange();};var c=function(h){var d=h.find("[data-from]"),f=h.find("[data-to]");var e=a.Sh.Date.call(d).setLimit(f.val(),"max");var g=a.Sh.Date.call(f).setLimit(d.val(),"min");d.datepicker("option","onSelect",function(i){g.setLimit(i,"min");});f.datepicker("option","onSelect",function(i){e.setLimit(i,"max");});};a.fn.ShDateRange=function(){return this.each(function(){if(!a(this).data("sh.daterange")){a(this).data("sh.daterange",new c(a(this)));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Expands=function(f){var e={onInit:this.data("oninit"),onShow:this.data("onshow"),onHide:this.data("onhide"),onToggle:this.data("ontoggle"),onBeforeShow:this.data("onbeforeshow"),onBeforeHide:this.data("onbeforehide"),guts:this.data("guts"),src:this.data("hsrc"),state:this.data("state"),active:this.data("active"),effect:this.data("effect"),togglecss:this.data("toggle-css"),hidesrc:this.data("hide-src"),showsrc:this.data("show-src")};this.ShExpands(a.extend(e,f));return this.data("sh.expands");};a.Sh.Expands.defaults={guts:">.guts",src:">.h",active:true,effect:"slide",togglecss:"toggle"};var b=function(e,f){this.element=e;this.options=a.extend({},a.Sh.Expands.defaults,f);this.srcElement=e.find(this.options.src);this.gutsElement=e.find(this.options.guts);this.init();};b.prototype={init:function(){var e=this;this.srcElement.length&&this.element.on("click",this.options.src,function(f){e._click(f);});this.options.hidesrc&&this.element.on("click",e.options.hidesrc,function(f){e._click(f,"hide");});this.options.showsrc&&this.element.on("click",e.options.showsrc,function(f){e._click(f,"show");});e.options.onInit&&e.options.onInit.call(this);if(e.options.state=="show"){e.show();}else{e.hide();}return this;},addtrigger:function(f,g){var e=this;f.on("click",function(h){e._click(h,g);});},addguts:function(e){this.gutsElement.add(e);},_click:function(g,h){var f=this;g.preventDefault();if(!f.options.active){return;}if(h=="hide"){f.hide();return;}if(h=="show"){f.show();return;}f.toggle();},show:function(){if(this.options.onBeforeShow){this.options.onBeforeShow();return this;}if(!this.gutsElement.is(":visible")){this.options.onToggle&&this.options.onToggle.call(this);switch(this.options.effect){case"slide":this.gutsElement.slideDown(50);break;case"fade":this.gutsElement.fadeIn();break;case"none":this.gutsElement.show();break;}}this.options.state="show";this.options.onShow&&this.options.onShow.call(this);return this;},toggle:function(){if(this.gutsElement.is(":visible")){this.hide();}else{this.show();}return this;},hide:function(){if(this.options.onBeforeHide){this.options.onBeforeHide();return this;}this.options.onToggle&&this.options.onToggle.call(this);switch(this.options.effect){case"slide":this.gutsElement.slideUp(100);break;case"fade":this.gutsElement.fadeOut();break;case"none":this.gutsElement.hide();break;}this.options.state=null;this.options.onHide&&this.options.onHide.call(this);return this;}};a.fn.ShExpands=function(e){return this.each(function(){if(!a(this).data("sh.expands")){a(this).data("sh.expands",new b(a(this),e));}});};a.Sh.AltExpands=function(){a.Sh.Expands.call(this,{onShow:function(){this.srcElement.hide();},onHide:function(){this.srcElement.show();}});};a.Sh.ExpandOnce=function(){a.Sh.Expands.call(this,{effect:"none",onShow:function(){this.srcElement.remove();}});};a.Sh.PopList=function(g){var e={onShow:function(){this.gutsElement.position({of:this.srcElement,my:"center top",at:"center bottom",collision:"fit fit"});}};var f=a.Sh.Expands.call(this,a.extend(e,g));this.data("ondocumentclick",function(h){if(!jQuery.contains(this.get(0),h.target)){f.hide();}});window.popbasket.push(this);return f;};a.Sh.ExpandLabel=function(i){var j,g;var f={mono:this.data("mono"),listsize:this.data("list-size"),gutscss:this.data("guts-css"),selector:this.data("selector"),slabel:this.data("show-label"),hlabel:this.data("hide-label")};f=a.extend({},a.Sh.ExpandLabel.defaults,f,i);if(f.mono){this.find(f.selector+":gt("+(f.listsize-1)+")").addClass(f.gutscss);}var e={onInit:function(){(this.options.state=="show")?this.srcElement.html(f.hlabel):this.srcElement.html(f.slabel);if(this.gutsElement.length==0){this.srcElement.hide();}},onShow:function(){this.srcElement.html(f.hlabel);},onHide:function(){this.srcElement.html(f.slabel);}};var h=a.Sh.Expands.call(this,a.extend(e,i));return h;};a.Sh.ExpandLabel.defaults={mono:false,gutscss:"guts",listsize:3,selector:"li",slabel:a.Res.More,hlabel:a.Res.Less};a.Sh.FilterList=function(g){var f=a.Sh.PopList.call(this,g);var e={itemselector:this.data("itemselector"),selected:this.data("selected"),selectedValue:this.data("selected-value"),css:this.data("css"),onchange:this.data("onchange"),html:this.data("html"),expands:f};this.ShFilterList(a.extend(e,g));};a.Sh.FilterList.defaults={itemselector:"li",css:"selected",html:false};var c=function(e,f){this.options=a.extend({},a.Sh.FilterList.defaults,f);this.element=e;this.expands=this.options.expands;this.items=this.expands.gutsElement.find(this.options.itemselector);if(!this.options.selected){this.options.selected=this.options.selectedValue?this.items.filter("[data-value='{0}']".format(this.options.selectedValue)):this.items.filter(this.options.css).first();if(!this.options.selected.length){this.options.selected=this.items.first();}}this.init(f);};c.prototype={init:function(f){var e=this;this.expands.gutsElement.on("click",this.options.itemselector,function(g){e._click(g,a(this));});this.select(this.options.selected);},_click:function(f,g){if(!this.options.selected.is(g)){this.items.removeClass(this.options.css);this.select(g);this.options.onchange&&this.options.onchangec.call(this,g);}this.expands.hide();f.preventDefault();},additem:function(e){a.merge(this.options.items,e);},select:function(e){e.addClass(this.options.css);this.options.html?this.expands.srcElement.html(e.html()):this.expands.srcElement.text(e.text());this.options.selected=e;}};a.fn.ShFilterList=function(e){return this.each(function(){if(!a(this).data("sh.filterlist")){a(this).data("sh.filterlist",new c(a(this),e));}});};a.Sh.Tabs=function(f){var e={onSelect:a.getEvent(this,"onselect"),onLoad:a.getEvent(this,"onload"),toggle:this.data("toggle"),effect:this.data("effect"),tabSelector:this.data("tabs"),selectcss:this.data("selected-css")};this.ShTabs(a.extend(e,f));return a(this).data("sh.tabs");};a.Sh.Tabs.defaults={delay:false,toggle:false,effect:"slide",selectcss:"selected"};var d=function(e,f){this.element=e;this.options=a.extend({},a.Sh.Tabs.defaults,f);this.collection=[];this.group=this.element.find(this.options.tabSelector);this.init();};d.prototype={init:function(){var e=this;a.each(e.group,function(h,j){var g=a.Sh.Expands.call(a(j),{effect:e.options.effect});g.gutsElement=a(a(j).data("guts"));e.collection.push(g);});var f=e.group.filter("."+e.options.selectcss);e.selected=f.length?f.data("sh.expands"):null;e.group.on("click",function(g){g.preventDefault();e.select(a(this).data("sh.expands"));});e.selected&&e.select(e.selected);e.options.onLoad&&e.options.onLoad.call(e);return this;},select:function(f){var e=this;if(f.options.state=="show"&&!e.options.toggle){return;}a.each(e.collection,function(g,h){h.hide();h.element.removeClass(e.options.selectcss);});f.show();f.element.addClass(e.options.selectcss);e.selected=f;e.options.onSelect&&e.options.onSelect.call(e);}};a.fn.ShTabs=function(e){return this.each(function(){if(!a(this).data("sh.tabs")){a(this).data("sh.tabs",new d(a(this),e));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Fieldset=function(e){var d=this.data("alt-text");if(this.find(this.data("trigger")).length){d=this.find(this.data("trigger").data("alt-text"));}var c={trigger:this.data("trigger"),remove:this.data("remove"),template:this.data("template"),collectionId:this.data("collection"),identifier:this.data("identifier"),isGreedy:this.data("greedy"),hookSelector:this.data("hook-selector"),addOnLoad:this.data("addonload"),altText:d,target:this.data("target"),onLoad:a.getEvent(this,"onload"),onAdd:a.getEvent(this,"onadd"),onRemove:a.getEvent(this,"onremove"),onBeforeAdd:a.getEvent(this,"onbeforeadd")};this.ShFieldset(a.extend(c,e));return a(this).data("sh.fieldset");};a.Sh.Fieldset.defaults={trigger:".addfs",remove:".remfs",template:"tmplfs",collectionId:".itemfs",isGreedy:false,addOnLoad:false,altText:a.Res.AddAnother,onBeforeAdd:function(c){return true;}};var b=function(c,d){this.options=a.extend({},a.Sh.Fieldset.defaults,d);this.element=c;this.template=a(this.options.template);this.trigger=(this.options.trigger instanceof jQuery)?this.options.trigger:this.element.find(this.options.trigger);this.target=this.element.find(this.options.target);this.options.originalText=this.trigger.text();this.init();};b.prototype={init:function(){var c=this;c.template.mustacheparse();c.element.on("click",c.options.remove,function(d){if(!a(this).is(c.options.remove)){return false;}d.preventDefault();c.remove(a(this).closest(c.options.collectionId));return false;});c.trigger.click(function(d){if(c.options.onBeforeAdd&&c.options.onBeforeAdd.call(c)){d.preventDefault();c.addNew(true);}});c._updateCollection();c.options.UniqueRowIndex=c.collection.length;c._updateAltText();if(c.options.addOnLoad&&!c.collection.length){c.addNew(false);}(c.options.onLoad)?c.options.onLoad.call(this):null;},addNew:function(d){var c=this;var e=a(c.template.mustache({RowIndex:c.collection.length,Identifier:c.options.identifier,UniqueRowIndex:c.options.UniqueRowIndex})).insertBefore(c.target).ShApplyHiLight();var g=c.getElementValue(e);var f={index:c.collection.length,item:e,value:g,UniqueRowIndex:c.options.UniqueRowIndex};e.data("row",f);c.collection.push(f);c._updateAltText(this);if(d){e.find(":text,textarea,select").first().focus();}if(!c.options.isGreedy){if(f.value==0){c.showTrigger(false);}}a.ShRewire(e);c.options.UniqueRowIndex++;_debug(c.collection,"collection");(c.options.onAdd)?c.options.onAdd.call(this,e):null;return this;},remove:function(e){var c=this;var d=e.data("row");c.collection.remove(c.indexOf(d));e.remove();c._updateAltText();if(!c.options.isGreedy){c.showTrigger(!c.isOneEmpty());}(c.options.onRemove)?c.options.onRemove.call(this,e):null;return d;},indexOf:function(f){var c=this;var e=-1;for(var d=0;d<c.collection.length;d++){if(c.collection[d].UniqueRowIndex==f.UniqueRowIndex){e=d;break;}}return e;},_updateCollection:function(){var d=[],e=0,c=this;a.each(c.element.find(c.options.collectionId),function(g,h){var f=a(this);var k=0;a.each(f.find(c.options.hookSelector),function(){var i=a.trim(a(this).val());if(i!=""&&i!="-1"){k++;}});var j={index:g,item:f,value:k,UniqueRowIndex:e++};f.data("row",j);d.push(j);});if(!c.options.isGreedy){c.element.on("keyup",c.options.hookSelector,function(f){c._AutoUpdateTrigger(a(this).closest(c.options.collectionId));});}c.collection=d;},setValue:function(d,e){var c=d.data("row");c.value=e;},getValue:function(c){return c.data("row").value;},getElementValue:function(d){var c=this;var e=0;a.each(d.find(c.options.hookSelector),function(){var f=a.trim(a(this).val());if(f!=""&&f!="-1"){e++;}});return e;},isOneEmpty:function(){var c=this;for(var d=0;d<c.collection.length;d++){if(c.collection[d].value==0){return true;}}return false;},showTrigger:function(d){var c=this;d?c.trigger.show():c.trigger.hide();},_updateAltText:function(){var c=this;(c.collection.length)?c.trigger.text(c.options.altText):c.trigger.text(c.options.originalText);return c.collection.length;},_AutoUpdateTrigger:function(d){var c=this;var e=c.getElementValue(d);c.setValue(d,e);c.showTrigger(!c.isOneEmpty());}};a.fn.ShFieldset=function(c){return this.each(function(){if(!a(this).data("sh.fieldset")){a(this).data("sh.fieldset",new b(a(this),c));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Radio=function(e){var d={container:this.data("container"),css:this.data("checked"),onCheck:a.getEvent(this,"oncheck"),onUncheck:a.getEvent(this,"onuncheck"),onChange:a.getEvent(this,"onchange"),onDblCheck:a.getEvent(this,"ondblcheck")};this.ShRadio(a.extend(d,e));return a(this).data("sh.radio");};a.Sh.Radio.defaults={container:"label",css:"checked"};var c=function(d,e){this.element=d;this.options=a.extend({},a.Sh.Radio.defaults,e);this.control=this.element.find('input[type="radio"]:first');this.group=a('input[name="'+this.control.attr("name")+'"]');this.checked=this.control.is(":checked");if(this.checked){this.element.addClass(this.options.css);}this.init();};c.prototype={init:function(){var d=this;d.control.on("click",function(){if(d.checked){if(d.options.onDblCheck){d.options.onDblCheck.call(d);}}else{d.group.each(function(){var e=a(this).closest(d.options.container);if(e.data("sh.radio")){e.removeClass(d.options.css).data("sh.radio").checked=false;}});d.element.addClass(d.options.css);d.checked=true;if(d.options.onCheck){d.options.onCheck.call(d);}}});d.control.on("change",function(){if(d.options.onChange){d.options.onChange.call(d,this.checked);}});return this;},uncheck:function(){var d=this;d.control.removeProp("checked");d.element.removeClass(d.options.css);d.checked=false;if(d.options.onUncheck){d.options.onUncheck.call(d);}return d;},add:function(d){this.group.add(element);}};a.fn.ShRadio=function(d){return this.each(function(){if(!a(this).data("sh.radio")){a(this).data("sh.radio",new c(a(this),d));}});};a.Sh.RadioGroup=function(h){var e=this,f=this.data("container")||"label",g=this.data("css"),d=this.find(f);d.each(function(){a.Sh.Radio.call(this,{container:f,css:g});});};a.Sh.Checkbox=function(e){var d={css:this.data("css"),onCheck:a.getEvent(this,"oncheck"),onUncheck:a.getEvent(this,"onuncheck")};this.ShCheckbox(a.extend(d,e));return a(this).data("sh.checkbox");};a.Sh.Checkbox.defaults={css:"checked"};var b=function(d,e){this.element=d;this.options=a.extend({},a.Sh.Checkbox.defaults,e);this.control=this.element.find('input[type="checkbox"]:first');this.group=a('input[name="'+this.control.attr("name")+'"]');this.checked=this.control.is(":checked");if(this.checked){this.element.addClass(this.options.css);}this.init();};b.prototype={init:function(e){var d=this;d.control.on("click",function(){this.checked?d.element.addClass(d.options.css):d.element.removeClass(d.options.css);d.checked=this.checked;if(d.options.onCheck){d.options.onCheck.call(d);}});return this;},uncheck:function(){var d=this;d.control.removeProp("checked");d.element.removeClass(d.options.css);d.checked=false;if(d.options.onUncheck){d.options.onUncheck.call(d);}return d;},add:function(d){this.group.add(element);}};a.fn.ShCheckbox=function(d){return this.each(function(){if(!a(this).data("sh.checkbox")){a(this).data("sh.checkbox",new b(a(this),d));}});};a.Sh.TallField=function(){var e=this.width()*0.9,d=this;this.on("blur",function(){var g=a("<span />").text(d.ShTrim()).appendTo(a.props.$body);var f=g.width();g.remove();if(f>e){d.addClass("clearit");}else{d.removeClass("clearit");}});this.trigger("blur");};})(jQuery);(function(a){a.fn.fieldValue=function(e){for(var g=[],c=0,d=this.length;c<d;c++){var b=this[c];var f=a.fieldValue(b,e);if(f===null||typeof f=="undefined"||(f.constructor==Array&&!f.length)){continue;}if(f.constructor==Array){a.merge(g,f);}else{g.push(f);}}return g;};a.fieldValue=function(c,l){var g=c.name,m=c.type,o=c.tagName.toLowerCase();if(l===undefined){l=true;}if(l&&(!g||c.disabled||m=="reset"||m=="button"||(m=="checkbox"||m=="radio")&&!c.checked||(m=="submit"||m=="image")&&c.form&&c.form.clk!=c||o=="select"&&c.selectedIndex==-1)){return null;}if(o=="select"){var e=c.selectedIndex;if(e<0){return null;}var b=[],k=c.options;var h=(m=="select-one");var f=(h?e+1:k.length);for(var d=(h?e:0);d<f;d++){var j=k[d];if(j.selected){var p=j.value;if(!p){p=(j.attributes&&j.attributes.value&&!(j.attributes.value.specified))?j.text:j.value;}if(h){return p;}b.push(p);}}return b;}return a(c).val();};a.fn.formToArray=function(o,d){var b=[];if(this.length===0){return b;}var f=this[0];var e=o?f.getElementsByTagName("*"):f.elements;if(!e){return b;}var g,h,m,p,c,l,k;for(g=0,l=e.length;g<l;g++){c=e[g];m=c.name;if(!m){continue;}p=a.fieldValue(c,true);if(p&&p.constructor==Array){if(d){d.push(c);}for(h=0,k=p.length;h<k;h++){b.push({name:m,value:p[h],type:c.type});}}else{if(p!==null&&typeof p!="undefined"){if(d){d.push(c);}b.push({name:m,value:p,type:c.type});}}}return b;};a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b);});};a.fn.clearFields=a.fn.clearInputs=function(b){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();if(c.test(d)||e=="textarea"){this.value="";}else{if(d=="checkbox"||d=="radio"){this.checked=false;}else{if(e=="select"){this.selectedIndex=null;}else{if(d=="file"){if(/MSIE/.test(navigator.userAgent)){a(this).replaceWith(a(this).clone());}else{a(this).val("");}}else{if(b){if((b===true&&/hidden/.test(d))||(typeof b=="string"&&a(this).is(b))){this.value="";}}}}}}});};a.fn.resetForm=function(){return this.each(function(){a("input,select,textarea",this).resetFields();});};a.fn.resetFields=function(){var b=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week|hidden)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();if(b.test(d)||e=="textarea"){this.value=this.defaultValue;}else{if(d=="checkbox"||d=="radio"){this.checked=this.defaultChecked;}else{if(e=="select"){for(var c=0;c<this.options;c++){this.options[c].selected=defaultSelected;}}}}});};a.fn.formToJson=function(){var b=this.formToArray(true);_debug(b,"input array");var c={};a.each(b,function(){if(c[this.name]!=null){if(!(c[this.name] instanceof Array)){var d=c[this.name];c[this.name]=[];c[this.name].push(d);}c[this.name].push(this.value);}else{c[this.name]=this.value;}});return c;};})(jQuery);
/*jQuery Knob*/
(function(a){if(typeof exports==="object"){module.exports=a(require("jquery"));}else{if(typeof define==="function"&&define.amd){define(["jquery"],a);}else{a(jQuery);}}}(function(a){var b={},c=Math.max,d=Math.min;b.c={};b.c.d=a(document);b.c.t=function(f){return f.originalEvent.touches.length-1;};b.o=function(){var e=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.w=0;this.h=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.scale=1;this.relative=false;this.relativeWidth=false;this.relativeHeight=false;this.$div=null;this.run=function(){var f=function(h,g){var i;for(i in g){e.o[i]=g[i];}e._carve().init();e._configure()._draw();};if(this.$.data("kontroled")){return;}this.$.data("kontroled",true);this.extend();this.o=a.extend({min:this.$.data("min")!==undefined?this.$.data("min"):0,max:this.$.data("max")!==undefined?this.$.data("max"):100,stopper:true,readOnly:this.$.data("readonly")||(this.$.attr("readonly")==="readonly"),cursor:this.$.data("cursor")===true&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),0.01)||0.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:this.$.data("displayinput")==null||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:false,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(g){return g;},parse:function(g){return parseFloat(g);}},this.o);this.o.flip=this.o.rotation==="anticlockwise"||this.o.rotation==="acw";if(!this.o.inputColor){this.o.inputColor=this.o.fgColor;}if(this.$.is("fieldset")){this.v={};this.i=this.$.find("input");this.i.each(function(h){var g=a(this);e.i[h]=g;e.v[h]=e.o.parse(g.val());g.bind("change blur",function(){var i={};i[h]=g.val();e.val(e._validate(i));});});this.$.find("legend").remove();}else{this.i=this.$;this.v=this.o.parse(this.$.val());this.v===""&&(this.v=this.o.min);this.$.bind("change blur",function(){e.val(e._validate(e.o.parse(e.$.val())));});}!this.o.displayInput&&this.$.hide();this.$c=a(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height});this.$div=a('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;" dir="ltr"></div>');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();if(typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(this.$c[0]);}this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c){throw {name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message;}};}this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=this.o.width%1!==0&&this.o.width.indexOf("%");this.relativeHeight=this.o.height%1!==0&&this.o.height.indexOf("%");this.relative=this.relativeWidth||this.relativeHeight;this._carve();if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv);}else{this.cv=this.v;}this.$.bind("configure",f).parent().bind("configure",f);this._listen()._configure()._xy().init();this.isInit=true;this.$.val(this.o.format(this.v));this._draw();return this;};this._carve=function(){if(this.relative){var g=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),f=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(g,f);}else{this.w=this.o.width;this.h=this.o.height;}this.$div.css({width:this.w+"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});if(this.scale!==1){this.$c[0].width=this.$c[0].width*this.scale;this.$c[0].height=this.$c[0].height*this.scale;this.$c.width(this.w);this.$c.height(this.h);}return this;};this._draw=function(){var f=true;e.g=e.c;e.clear();e.dH&&(f=e.dH());f!==false&&e.draw();};this._touch=function(f){var g=function(h){var i=e.xy2val(h.originalEvent.touches[e.t].pageX,h.originalEvent.touches[e.t].pageY);if(i==e.cv){return;}if(e.cH&&e.cH(i)===false){return;}e.change(e._validate(i));e._draw();};this.t=b.c.t(f);g(f);b.c.d.bind("touchmove.k",g).bind("touchend.k",function(){b.c.d.unbind("touchmove.k touchend.k");e.val(e.cv);});return this;};this._mouse=function(f){var g=function(h){var i=e.xy2val(h.pageX,h.pageY);if(i==e.cv){return;}if(e.cH&&(e.cH(i)===false)){return;}e.change(e._validate(i));e._draw();};g(f);b.c.d.bind("mousemove.k",g).bind("keyup.k",function(h){if(h.keyCode===27){b.c.d.unbind("mouseup.k mousemove.k keyup.k");if(e.eH&&e.eH()===false){return;}e.cancel();}}).bind("mouseup.k",function(h){b.c.d.unbind("mousemove.k mouseup.k keyup.k");e.val(e.cv);});return this;};this._xy=function(){var f=this.$c.offset();this.x=f.left;this.y=f.top;return this;};this._listen=function(){if(!this.o.readOnly){this.$c.bind("mousedown",function(f){f.preventDefault();e._xy()._mouse(f);}).bind("touchstart",function(f){f.preventDefault();e._xy()._touch(f);});this.listen();}else{this.$.attr("readonly","readonly");}if(this.relative){a(window).resize(function(){e._carve().init();e._draw();});}return this;};this._configure=function(){if(this.o.draw){this.dH=this.o.draw;}if(this.o.change){this.cH=this.o.change;}if(this.o.cancel){this.eH=this.o.cancel;}if(this.o.release){this.rH=this.o.release;}if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6");}else{this.fgColor=this.o.fgColor;}return this;};this._clear=function(){this.$c[0].width=this.$c[0].width;};this._validate=function(f){var g=(~~(((f<0)?-0.5:0.5)+(f/this.o.step)))*this.o.step;return Math.round(g*100)/100;};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(f){};this.val=function(f){};this.xy2val=function(f,g){};this.draw=function(){};this.clear=function(){this._clear();};this.h2rgba=function(g,f){var i;g=g.substring(1,7);i=[parseInt(g.substring(0,2),16),parseInt(g.substring(2,4),16),parseInt(g.substring(4,6),16)];return"rgba("+i[0]+","+i[1]+","+i[2]+","+f+")";};this.copy=function(g,j){for(var h in g){j[h]=g[h];}};};b.Dial=function(){b.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=a.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:true},this.o);};this.val=function(f,e){if(null!=f){f=this.o.parse(f);if(e!==false&&f!=this.v&&this.rH&&this.rH(f)===false){return;}this.cv=this.o.stopper?c(d(f,this.o.max),this.o.min):f;this.v=this.cv;this.$.val(this.o.format(this.v));this._draw();}else{return this.v;}};this.xy2val=function(g,h){var e,f;e=Math.atan2(g-(this.x+this.w2),-(h-this.y-this.w2))-this.angleOffset;if(this.o.flip){e=this.angleArc-e-this.PI2;}if(this.angleArc!=this.PI2&&(e<0)&&(e>-0.5)){e=0;}else{if(e<0){e+=this.PI2;}}f=(e*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(f=c(d(f,this.o.max),this.o.min));return f;};this.listen=function(){var k=this,j,i,h=function(o){o.preventDefault();var p=o.originalEvent,m=p.detail||p.wheelDeltaX,n=p.detail||p.wheelDeltaY,q=k._validate(k.o.parse(k.$.val()))+(m>0||n>0?k.o.step:m<0||n<0?-k.o.step:0);q=c(d(q,k.o.max),k.o.min);k.val(q,false);if(k.rH){clearTimeout(j);j=setTimeout(function(){k.rH(q);j=null;},100);if(!i){i=setTimeout(function(){if(j){k.rH(q);}i=null;},200);}}},f,l,g=1,e={37:-k.o.step,38:k.o.step,39:k.o.step,40:-k.o.step};this.$.bind("keydown",function(m){var n=m.keyCode;if(n>=96&&n<=105){n=m.keyCode=n-48;}f=parseInt(String.fromCharCode(n));if(isNaN(f)){(n!==13)&&n!==8&&n!==9&&n!==189&&(n!==190||k.$.val().match(/\./))&&m.preventDefault();if(a.inArray(n,[37,38,39,40])>-1){m.preventDefault();var o=k.o.parse(k.$.val())+e[n]*g;k.o.stopper&&(o=c(d(o,k.o.max),k.o.min));k.change(k._validate(o));k._draw();l=window.setTimeout(function(){g*=2;},30);}}}).bind("keyup",function(m){if(isNaN(f)){if(l){window.clearTimeout(l);l=null;g=1;k.val(k.$.val());}}else{(k.$.val()>k.o.max&&k.$.val(k.o.max))||(k.$.val()<k.o.min&&k.$.val(k.o.min));}});this.$c.bind("mousewheel DOMMouseScroll",h);this.$.bind("mousewheel DOMMouseScroll",h);};this.init=function(){if(this.v<this.o.min||this.v>this.o.max){this.v=this.o.min;}this.$.val(this.v);this.w2=this.w/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var e=c(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:((this.w/2+4)>>0)+"px",height:((this.w/3)>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":((this.w/3)>>0)+"px","margin-left":"-"+((this.w*3/4+2)>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+((this.w/e)>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"});};this.change=function(e){this.cv=e;this.$.val(this.o.format(e));};this.angle=function(e){return(e-this.o.min)*this.angleArc/(this.o.max-this.o.min);};this.arc=function(g){var f,e;g=this.angle(g);if(this.o.flip){f=this.endAngle+1e-05;e=f-g-1e-05;}else{f=this.startAngle-1e-05;e=f+g+1e-05;}this.o.cursor&&(f=e-this.cursorExt)&&(e=e+this.cursorExt);return{s:f,e:e,d:this.o.flip&&!this.o.cursor};};this.draw=function(){var f=this.g,e=this.arc(this.cv),g,h=1;f.lineWidth=this.lineWidth;f.lineCap=this.lineCap;if(this.o.bgColor!=="none"){f.beginPath();f.strokeStyle=this.o.bgColor;f.arc(this.xy,this.xy,this.radius,this.endAngle-1e-05,this.startAngle+1e-05,true);f.stroke();}if(this.o.displayPrevious){g=this.arc(this.v);f.beginPath();f.strokeStyle=this.pColor;f.arc(this.xy,this.xy,this.radius,g.s,g.e,g.d);f.stroke();h=this.cv==this.v;}f.beginPath();f.strokeStyle=h?this.o.fgColor:this.fgColor;f.arc(this.xy,this.xy,this.radius,e.s,e.e,e.d);f.stroke();};this.cancel=function(){this.val(this.v);};};a.fn.dial=a.fn.knob=function(e){return this.each(function(){var f=new b.Dial();f.o=e;f.$=a(this);f.run();}).parent();};}));(function(a){if(!a.Sh){a.Sh={};}a.Sh.Knob=function(c){var b={release:a.getEvent("release"),change:a.getEvent("change"),draw:a.getEvent("draw"),cancel:a.getEvent("cancel"),error:a.getEvent("error")};this.knob(a.extend(b,c));};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Label=function(d){var c={text:this.data("label-text"),sticky:this.data("sticky"),css:this.data("label-css"),closecss:"closelabel",closetext:this.data("close-text"),showclosebtn:this.data("show-close"),location:this.data("label-location"),which:this.data("which"),showOnLoad:this.data("show-onload"),valid:true,onShow:a.getEvent(this,"onshow"),onLoad:a.getEvent(this,"onload"),onHide:a.getEvent(this,"onhide"),};this.ShLabel(a.extend(c,d));return this.data("sh.label");};a.Sh.Label.defaults={text:a.Res.Error,sticky:false,css:"",closecss:"closelabel",closetext:a.Res.Dismiss,showclosebtn:false,location:"afterEnd",showOnLoad:false,valid:true,};var b=function(c,d){this.options=a.extend({},a.Sh.Label.defaults,d);this.element=c;this.$err=a("<span></span>").addClass(this.options.css).html(this.options.text);this.$closebtn=a("<span />").text(this.options.closetext).addClass(this.options.closecss);this.init(this.options);};b.prototype={init:function(c){a.extend(this.options,c);if(this.options.showOnLoad){this.show(this.options.text);}(this.options.onLoad)?this.options.onLoad.call(this.element):null;return this;},show:function(e){var d=this;var f=a.extend({},this.options,e);if(!this.options.locked){this.options.locked=true;this.$err.removeClass(this.options.newCss);this.$err.addClass(f.css);this.$err.css("opacity",1);this.$err.html(f.text);this.options.newCss=f.css;var c=f.which?this.element.closest(f.which):this.element;switch(f.location){case"beforeStart":this.$err.insertBefore(c);break;case"afterStart":this.$err.prependTo(c);break;case"beforeEnd":this.$err.appendTo(c);break;case"afterEnd":default:this.$err.insertAfter(c);break;}(this.options.onShow)?this.options.onShow.call(this.element):null;if(!f.sticky){d.$err.delay(3000).animate({opacity:0},"slow",function(){d.$err.remove();d.options.locked=false;(d.options.onHide)?d.options.onHide.call(d.element):null;});}else{this.options.valid=false;if(f.showCloseBtn){this.$err.append(this.$closebtn);}this.$closebtn.on("click",function(){d.hide.call(d.element);});}}return this.element;},hide:function(){this.$err.remove();this.options.locked=false;(this.options.onHide)?this.options.onHide.call(this.element):null;if(this.options.sticky){this.options.valid=true;}return this.element;}};a.fn.ShLabel=function(c){return this.each(function(){if(!a(this).data("sh.label")){a(this).data("sh.label",new b(a(this),c));}});};})(jQuery);(function(a){a.fn.jqm=function(n){return this.each(function(){var p=a(this),q=p.data("jqm")||a.extend({ID:h++},a.jqm.params),r=a.extend(q,n);p.data("jqm",r).addClass("jqm-init")[0]._jqmID=r.ID;r.trigger&&p.jqmAddTrigger(r.trigger);});};a.fn.jqmAddTrigger=function(n){return this.each(function(){if(!c(a(this),"jqmShow",n)){e("jqmAddTrigger must be called on initialized modals");}});};a.fn.jqmAddClose=function(n){return this.each(function(){if(!c(a(this),"jqmHide",n)){e("jqmAddClose must be called on initialized modals");}});};a.fn.jqmShow=function(n){return this.each(function(){!this._jqmShown&&l(a(this),n);});};a.fn.jqmHide=function(n){return this.each(function(){this._jqmShown&&g(a(this),n);});};var e=function(n){if(window.console&&window.console.error){window.console.error(n);}},l=function(n,r){var q=n.data("jqm"),r=r||window.event,x=(parseInt(n.css("z-index"))),x=(x>0)?x:3000,w=a("<div></div>").addClass(q.overlayClass).css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":x-1,opacity:q.overlay/100}),p={w:n,c:q,o:w,t:r};n.css("z-index",x);if(q.ajax){var s=q.target||n,u=q.ajax;s=(typeof s=="string")?a(s,n):a(s);if(u.substr(0,1)=="@"){u=a(r).attr(u.substring(1));}s.load(u,function(){q.onLoad&&q.onLoad.call(this,p);});if(q.ajaxText){s.html(q.ajaxText);}k(p);}else{k(p);}},g=function(n,r){var q=n.data("jqm"),r=r||window.event,p={w:n,c:q,o:n.data("jqmv"),t:r};d(p);},j=function(n){if(n.c.overlay>0){n.o.prependTo("body");}n.w.show();a.jqm.focusFunc(n.w,true);return true;},i=function(n){n.w.hide()&&n.o&&n.o.remove();return true;},c=function(n,p,q){var o=n.data("jqm");if(!n.data("jqm")){return false;}return a(q).each(function(){this[p]=this[p]||[];if(a.inArray(o.ID,this[p])<0){this[p].push(o.ID);a(this).click(function(){var r=this;n[p](this);return false;});}});},k=function(p){var n=p.w,r=p.o,q=p.c;if(q.onShow(p)!==false){n[0]._jqmShown=true;if(q.modal){!b[0]&&f("bind");b.push(n[0]);}else{n.jqmAddClose(r);}q.closeClass&&n.jqmAddClose(a("."+q.closeClass,n));q.toTop&&r&&n.before('<span id="jqmP'+q.ID+'"></span>').insertAfter(r);n.data("jqmv",r);n.unbind("keydown",a.jqm.closeOnEscFunc);if(q.closeOnEsc){n.attr("tabindex",0).bind("keydown",a.jqm.closeOnEscFunc).focus();}}},d=function(p){var n=p.w,r=p.o,q=p.c;if(q.onHide(p)!==false){n[0]._jqmShown=false;if(q.modal){b.pop();!b[0]&&f("unbind");}q.toTop&&r&&a("#jqmP"+q.ID).after(n).remove();}},f=function(n){a(document)[n]("keypress keydown mousedown",m);},m=function(o){var p=a(o.target).data("jqm")||a(o.target).parents(".jqm-init:first").data("jqm");var n=b[b.length-1];return(p&&p.ID==n._jqmID)?true:a.jqm.focusFunc(n,o);},h=0,b=[];a.jqm={params:{overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",closeOnEsc:false,trigger:".jqModal",ajax:false,target:false,ajaxText:"",modal:false,toTop:false,onShow:j,onHide:i,onLoad:false},focusFunc:function(n,o){if(o){a(":input:visible:first",n).focus();}return false;},closeOnEscFunc:function(n){if(n.keyCode==27){a(this).jqmHide();return false;}}};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Modal=function(d){var c={overlayClass:this.data("olcss"),closeClass:this.data("closecss"),trigger:this.data("trigger"),ajax:this.data("ajax"),target:this.data("target"),ajaxText:String('<div class="loading">{0}</div>').format(this.data("loading-text")),modal:this.data("ismodal"),onShow:a.getEvent(this,"onshow"),onHide:a.getEvent(this,"onhide"),onLoad:a.getEvent(this,"onload"),mode:this.data("mode")};this.ShModal(a.extend(c,d));return a(this).data("sh.modal");};a.fn.ShModal=function(c){return this.each(function(){if(!a(this).data("sh.modal")){a(this).data("sh.modal",new b(a(this),c));}});};a.Sh.Modal.defaults={overlay:100,overlayClass:"jqmOverlay",closeClass:"jqmClose",closeOnEsc:true,ajax:false,target:"#jqmContent",ajaxText:'<div class="loading"></div>',modal:false,toTop:false,mode:"ajax"};a.extend(a.jqm.params,a.Sh.Modal.defaults);var b=function(c,d){this.options=a.extend({},a.jqm.params,d);c.jqm({overlay:this.options.overlay,overlayClass:this.options.overlayClass,closeClass:this.options.closeClass,closeOnEsc:this.options.closeOnEsc,trigger:this.options.trigger,ajax:this.options.ajax,target:this.options.target,ajaxText:this.options.ajaxText,modal:this.options.modal,toTop:this.options.toTop,onShow:this.options.onShow,onHide:this.options.onHide,onLoad:this.options.onLoad,mode:this.options.mode});};a.Sh.Modals={defaults:{ajaxDialog:"#ajaxDialog",frameDialog:"#frameDialog",contentDialog:"#contentDialog",loadingcss:".loading",modal:true},rewire:function(e){if(a.Sh.Modals.Ready){var d=(e)?e.find("[data-modal=iframe]"):"[data-modal=iframe]";var f=(e)?e.find("[data-modal=ajax]"):"[data-modal=ajax]";a.Sh.Modals.frameDialog.jqmAddTrigger(d);a.Sh.Modals.ajaxDialog.jqmAddTrigger(f);a.Sh.Modals.bindContent(e);}},hideAll:function(){try{a.Sh.Modals.ajaxDialog.jqmHide();a.Sh.Modals.frameDialog.jqmHide();a("[data-modal=inpage]").jqmHide();}catch(c){if(window.top&&window.top.$.Sh.Modals.frameDialog){window.top.$.Sh.Modals.frameDialog.jqmHide();}}},bindContent:function(c){if(a.Sh.Modals.contentDialog.length>0){var d=a.Sh.Modals.contentDialog.html();c=c||a.props.$body;a.each(c.find("[data-modal=inpage]"),function(f,g){var g=a(g);var e=g.data("modal-trigger");g.wrapInner('<div id="jqmContent"></div>');g.prepend(d);a.Sh.Modal.call(g,{mode:"inpage",modal:true,trigger:e,ajax:false,onShow:a.Sh.Modals.onShow,onHide:a.Sh.Modals.onHide});});}},windows:[],Ready:false,onShow:function(h){var i=a.getEvent(a(h.t),"onbeforeshow");if(i&&!i.call(h)){return false;}h.o.prependTo("body");var e=a(h.t);h.c.modal=e.data("ismodal");h.c.original=e;h.w.width("").height("").css("top","").css("left","");var g=e.data("style"),f=e.data("span");if(h.c.added!=true){a.Sh.Modals.windows.push(h);h.c.added=true;}h.w.addClass(g);a("h3",h.w).text(e.attr("title")||e.attr("data-title")||"");h.w.css("left",(a.props.width-h.w.width())/2);if(f=="fill"){h.w.css("top",a.props.height*0.05).height(a.props.height*0.9);}var d;if(h.c.mode=="iframe"){d=a("iframe",h.w);d.bind("load",function(j){h.w.find(a.Sh.Modals.defaults.loadingcss).hide();}).html("").attr("src",e.attr("href"));}var c=h.w.find("."+h.c.closeClass);e.data("noclose")?c.hide():c.show();h.w.show();if(h.c.mode=="iframe"){d.height(h.w.height()-a("h3",h.w).outerHeight(true));}return true;},onHide:function(c){var d=a.getEvent(c.c.original,"onbeforehide");if(d&&!d.call(c)){return false;}c.w.removeClass(c.c.original.data("style")).hide();c.o.remove();if(c.c.mode=="iframe"){a("iframe",c.w).unbind("load").attr("src","");c.w.find(a.Sh.Modals.defaults.loadingcss).hide();}if(c.c.mode=="ajax"){c.w.find(c.c.target).empty();}return true;},onLoad:function(c){if(c.c.mode=="ajax"){a.ShRewire(c.w);}var d=a.getEvent(a(c.t),"onafterload");d&&d.call(c);}};a(function(){a.Sh.Modals.ajaxDialog=a(a.Sh.Modals.defaults.ajaxDialog);a.Sh.Modals.frameDialog=a(a.Sh.Modals.defaults.frameDialog);a.Sh.Modals.contentDialog=a(a.Sh.Modals.defaults.contentDialog);a.Sh.Modal.call(a.Sh.Modals.ajaxDialog,{mode:"ajax",modal:true,trigger:"[data-modal=ajax]",ajax:"@href",onShow:a.Sh.Modals.onShow,onLoad:a.Sh.Modals.onLoad,onHide:a.Sh.Modals.onHide});a.Sh.Modal.call(a.Sh.Modals.frameDialog,{mode:"iframe",modal:true,trigger:"[data-modal=iframe]",onShow:a.Sh.Modals.onShow,onLoad:a.Sh.Modals.onLoad,onHide:a.Sh.Modals.onHide});a.Sh.Modals.bindContent();a.props.$window.on("resize",function(){a.each(a.Sh.Modals.windows,function(d,e){e.w.css("left",(a.props.width-e.w.width())/2);if(a(e.t).data("span")=="fill"){e.w.css("top",a.props.height*0.05).height(a.props.height*0.9);}if(e.c.mode=="iframe"){var c=a("iframe",e.w);c.height(e.w.height()-a("h3",e.w).outerHeight(true));}});});a.props.$body.trigger("ModalsReady");a.Sh.Modals.Ready=true;});})(jQuery);(function(a){if(!a.Sh){a.Sh={};}a.Sh.Pager=function(d){var c={tmpl:(this.data("tmpl-id"))?a("#"+this.data("tmpl-id")):undefined,target:a(this.data("target")),pagesize:this.data("page-size"),childselector:this.data("childselector"),trigger:this.data("trigger"),onpage:a.getEvent(this,"onpage")};this.ShPager(a.extend(c,d));};a.Sh.Pager.defaults={tmpl:a("#tmpl_paged_array"),pagesize:25,childselector:"li",trigger:".amore"};var b=function(c,d){this.options=a.extend({},a.Sh.Pager.defaults,d);this.element=c;this.template=this.options.tmpl.length?this.options.tmpl:null;this.options.trigger=this.element.find(this.options.trigger);this.init(d);};b.prototype={init:function(d){var c=this;a.Sh.Ajax.call(this.element,{method:"GET",onfinish:function(f,g){if(f.result){var e=(c.template)?a(c.template.mustache(f.d)):a(a.parseHTML(f.d));e.appendTo(c.options.target);a.ShRewire(e);if(f.d.IsLastPage||e.filter(c.options.childselector).length<c.options.pagesize){this.hide();}this.data("sh.ajax").addparams(f.pageparams);if(c.options.onpage){c.options.onpage.call(this,e);}}else{a.BodyLabel(f.errorCode,{css:"gerrorbox",sticky:true});}}});return this;}};a.fn.ShPager=function(c){return this.each(function(){if(!a(this).data("sh.pager")){a(this).data("sh.pager",new b(a(this),c));}});};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}if(!a.UiSh){a.UiSh={};}a.Sh.FormatRules={email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,integer:/^[0-9]*$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/,digits:/^-?(?:\d*)?(?:\.\d+)?$/,phone:/^[\d\s]*$/,date:""};a.Sh.Validate=function(e){var f="required";if(this.attr("data-format")){f="format";}else{if(this.attr("data-min")||this.attr("data-max")){f="range";}else{if(this.attr("data-min-length")||this.attr("data-max-length")){f="rangelength";}else{if(this.attr("data-required")){f="required";}else{if(this.attr("data-custom")){f="custom";}}}}}var d={required:this.data("required"),onshow:a.getEvent(this,"onshow"),onload:a.getEvent(this,"onload"),onhide:a.getEvent(this,"onhide"),onvalidate:a.getEvent(this,"onvalidate"),inputcss:this.data("inputcss"),reqcss:this.data("reqcss"),errlabelcss:this.data("errcss"),customlabelcss:this.data("customcss"),errlocation:this.data("err-location"),errmsg:this.data("err-message"),reqmsg:this.data("required-message"),showonload:this.data("showonload"),valid:this.data("valid"),type:f,format:this.data("format"),min:this.data("min"),max:this.data("max"),minLength:this.data("min-length"),maxLength:this.data("max-length"),skip:this.data("skip"),asyncvalid:this.data("async-valid")};this.ShValidate(a.extend(d,e));return this.data("sh.validate");};a.Sh.Validate.defaults={required:false,inputcss:"error",reqcss:"req",reqmsg:a.Res.Required,errlabelcss:"errlabel",errmsg:a.Res.Required,customlabelcss:"cerrlabel",errlocation:"afterEnd",showonload:false,valid:null,skip:false,asyncvalid:true};var b=function(d,e){this.options=a.extend({},a.Sh.Validate.defaults,e);this.element=d;if(this.options.type=="custom"){this.custom(e);}else{this.init(e);}};b.prototype={init:function(f){var d=this,e=this.element;if(d.options.required){e.wrap('<div class="wrapvld"></div>').addClass(d.options.reqcss).after(a("<span></span>").addClass(d.options.reqcss));}else{e.wrap('<div class="wrapvld"></div>');}e.ShLabel({text:d.options.errmsg,sticky:true,showCloseBtn:false,css:d.options.errlabelcss+(d.options.required?"":" unlabel"),location:d.options.errlocation,showOnLoad:d.options.showonload,valid:d.options.valid,onShow:function(){e.addClass(d.options.inputcss);if(d.options.onshow){d.options.onshow.call(this);}},onLoad:d.options.onload,onHide:function(){e.removeClass(d.options.inputcss);if(d.options.onhide){d.options.onhide.call(this);}}});e.on("change",function(){d.options.valid=false;});e.on("focus keydown",function(){e.data("sh.label").hide();});return this;},methods:{required:function(e,d){this.options.valid=true;if(e===""){d.show({text:this.options.errmsg||a.Res.Required});this.options.valid=false;}return this.options.valid;},format:function(k,h){var g=this.options.format,i=this.options.errmsg||a.Res.Tiny.INVALID_FORMAT;this.options.valid=true;var j=a.Sh.FormatRules[g]||new RegExp(g,"i");if(g in a.Sh.FormatRules){i=this.options.errmsg||a.Res.Tiny["INVALID_"+g+"_FORMAT"];}if(g=="date"){try{a.datepicker.parseDate(a.Res.Localization.DateFormat,k);}catch(d){this.options.valid=false;}}else{if(j.test(k)==false){this.options.valid=false;}}if(!this.options.valid){h.show({text:i});}return this.options.valid;},range:function(h,d){this.options.valid=true;h=Number(h);var f=parseInt(this.options.min),e=parseInt(this.options.max),g=this.options.errmsg||a.Res.Tiny.INVALID_VALUE;if(isNaN(h)){this.options.valid=false;d.show({text:g});return false;}if((f!=null&&f>h)||(e!=null&&e<h)){this.options.valid=false;d.show({text:g});return false;}return true;},rangelength:function(h,e){this.options.valid=true;var g=parseInt(this.options.minLength),f=parseInt(this.options.maxLength);var d=h.length;if(!isNaN(g)&&g>d){this.options.valid=false;e.show({text:this.options.errmsg||a.Res.Tiny.TOO_SHORT});}else{if(!isNaN(f)&&f<d){this.options.valid=false;e.show({text:this.options.errmsg||a.Res.Tiny.TOO_LONG});}}return this.options.valid;}},validate:function(){var d=this,e=this.element,f=e.data("sh.label");if(d.options.type=="custom"){if(d.options.onvalidate){return d.options.onvalidate.call(d,f);}_debug(e,"custom validation not implemented");return false;}var g=e.ShTrim();if(!d.options.type!="required"&&d.options.required&&g===""){f.show({text:d.options.reqmsg});return false;}if(g!==""&&!d.methods[d.options.type].call(d,g,f)){return false;}if(d.options.onvalidate){return d.options.onvalidate.call(d,g,f);}return true;},custom:function(){var d=this;this.element.ShLabel({text:d.options.errmsg,sticky:true,showCloseBtn:false,css:d.options.customlabelcss,location:d.options.errlocation,showOnLoad:d.options.showonload,valid:d.options.valid,onShow:d.options.onshow,onLoad:d.options.onload,onHide:d.options.onhide});return this;}};a.fn.ShValidate=function(d){return this.each(function(){if(!a(this).data("sh.validate")){a(this).data("sh.validate",new b(a(this),d));}});};a.Sh.ValidateForm=function(e){var d={fields:null,context:this.data("context"),trigger:this.data("trigger")?this.find(this.data("trigger")):this,offset:this.data("offset"),selector:this.data("validate-selector"),bDoValidate:this.data("dovalidate"),silent:this.data("silent")};this.ShValidateForm(a.extend(d,e));};a.Sh.ValidateForm.defaults={fields:null,silent:false,trigger:null,selector:".validate",offset:0,bDoValidate:true};var c=function(d,e){this.element=d;this.options=a.extend({},a.Sh.ValidateForm.defaults,e);if(!this.options.fields){this.options.fields=a(this.options.selector,this.context||a.props.$body);}this.context=this.options.context||window;this.init(this.options);};c.prototype={init:function(e){a.extend(this.options,e);var d=this;if(!this.options.silent){if(this.options.trigger.is("form")){this.options.trigger.on("submit",function(f){if(!f.isDefaultPrevented()&&!d.validate()){return false;}});}else{this.options.trigger.on("click",function(f){if(!f.isDefaultPrevented()&&!d.validate()){return false;}});}}},validate:function(){var d=this,f=this.element,h=true,g=0,e=false;a.each(this.options.fields,function(l,n){var k=a(this),m=k.data("sh.label"),p=k.data("sh.validate");m.hide();if(!jQuery.support.placeholder){if(k.hasClass("placeholder")&&k.val()==k.attr("placeholder")){k.val("");}}if(d.options.bDoValidate){if(!p.options.skip&&(!p.options.asyncvalid||!p.validate())){if(!p.options.asyncvalid){k.trigger("AsnycError");}h=false;if(!e){var j=k.is(":visible")?k:k.parent();if(d.context==window){g=j.offset().top-d.options.offset;}else{if(d.context&&d.context.length){g=j.ShPosition(d.context).top-d.options.offset;}}e=true;}}}});if(!h){if(d.context==window){if(a.props.$window.scrollTop()>g){a("html, body").animate({scrollTop:g},"fast","swing");}}else{if(d.context&&d.context.length){if(d.context.scrollTop()>g){d.context.animate({scrollTop:g},"fast","swing");}}}return false;}return true;}};a.fn.ShValidateForm=function(d){return this.each(function(){if(!a(this).data("sh.validateform")){a(this).data("sh.validateform",new c(a(this),d));}});};a.UiSh.Size=function(h,f){var g=parseInt(this.element.data("size")||500);if(isNaN(g)){g=500;}g=g*1000;if(!window.FileReader){return true;}var d=this.element.get(0);if(d.files&&d.files[0]){var e=parseInt(d.files[0].size);_debug(e,"file size");if(e<=g){return true;}f.show({text:a.Res.Tiny.FILE_LARGE});return false;}return true;};a.UiSh.Options=function(h,d){var g=this.element.find(":selected");var f=this.element.data("options-min");var e=this.element.data("options-max");this.options.errmsg;if((f!=null&&f>g.length)||(e!=null&&e<g.length)){d.show();return false;}return true;};})(jQuery);(function(a){if(!a.Sh){a.Sh={};}if(!a.UiSh){a.UiSh={};}var b;a(function(){if(jQuery.support.touch){a.props.$body.addClass("touch");}else{a.props.$body.addClass("notouch");}b=a.Sh.Label.call(a.props.$body,{text:"",css:"gerrorbox",location:"beforeEnd",sticky:false});});a.BodyLabel=function(f,g){b.hide();if(f!="hide"){if(g.sticky){g.showCloseBtn=true;}b.show(a.extend({text:a.ErrMessage(f,null,g.ns?g.ns:"Detailed")},g));}};a.ErrMessage=function(f,h,i){if(!i){i="Tiny";}var f=f||"Unknown",g=h||a.Res[i]["Unknown"];if(f!=0){f=a.Res[i][f];if(f){g=f;}}return g;};a.fn.mustacheparse=function(){return a(this).map(function(g,f){var j=a.trim(a(f).html());var h=Mustache.parse(j);return a(h).get();});};a.fn.ShPosition=function(f){var h=this.offset(),g=f.offset();return{top:h.top+f.scrollTop()-g.top,left:h.left-g.left};};a.fn.ShApplyHiLight=function(){if(this.effect){return this.effect("highlight",{},1000);}else{return this;}};a.fn.ShBadge=function(h,g,f){this.ShLabel({text:h||a.Res.SomeError,css:f||"redbox block",location:g||"beforeStart",sticky:true});return this;};a.fn.ShTrim=function(f){if(!this.is(":file")){f?this.val(a.trim(f)):this.val(a.trim(this.val()));}return this.val();};a.fn.ShVal=function(f){return this.val(f).trigger("change");};a.UiSh.removeParent=function(g,h){if(g.result){var f=this;setTimeout(function(){f.closest(f.data("which")||"li").fadeOut(500,function(){a(this).remove();if(h&&typeof(h)=="function"){h.call(f);}});},10);}else{this.ShLabel({which:this.data("which"),text:a.ErrMessage(g.errorCode,this.data("error-message")),css:this.data("errorcss"),location:this.data("error-location")||"beforeEnd",sticky:true});this.data("sh.label").show();}};a.Sh.WizardList=function(){this.ShWizardList();};var e=function(g,h){var f=false;a.each(g.find(">li"),function(){var i=a(this);if(i.hasClass("selected")||f){f=true;i.addClass("inactive").find("a").contents().unwrap();}});return this;};a.fn.ShWizardList=function(f){return this.each(function(){if(!a(this).data("sh.wizardlist")){a(this).data("sh.wizardlist",new e(a(this),f));}});};a.Sh.Confirm=function(g){var f={message:this.data("message")};this.ShConfirm(a.extend(f,g));};var c=function(g,h){this.options=h;var f=this;g.click(function(j){var i=a(this);if(j.isDefaultPrevented()){return false;}if(!window.confirm(f.options.message.replace(/\\n/gim,"\n"))){j.stopPropagation();j.preventDefault();return false;}});return this;};a.fn.ShConfirm=function(f){return this.each(function(){if(!a(this).data("sh.confirm")){a(this).data("sh.confirm",new c(a(this),f));}});};a.Sh.Tip=function(g){var f={_my:this.data("my"),_at:this.data("at"),_extra:this.data("addclass")};f=a.extend(f,g);this.ShTip(f);};a.Sh.Tip.defaults={_my:"center-2 bottom-15",_at:"center top",_extra:""};var d=function(g,h){this.options=h;var f=this;this.options=a.extend({},a.Sh.Tip.defaults,h);if(jQuery.support.touch){return this;}g.tooltip({show:false,hide:false,position:{my:f.options._my,at:f.options._at,using:function(k,j){var i=a(this).css(k).addClass(j.vertical).addClass(f.options._extra);if(j.element.width<50){i.addClass("tight");}else{if(j.element.width>100){i.addClass("wide");}}}}});g.attr("data-title",g.attr("title"));return this;};a.fn.ShTip=function(f){return this.each(function(){if(!a(this).data("sh.tip")){a(this).data("sh.tip",new d(a(this),f));}});};})(jQuery);